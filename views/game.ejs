<%- include('partials/header') %>


  <div class="wrapper">
    <a href="/games" class="back-link">‚Üê Back to Games</a>

    <div class="game-container">

    <div class="game-card">
      <img src="<%= game.cover ? game.cover.url.replace('t_thumb', 't_cover_big') : '/placeholder.jpg' %>" alt="<%= game.name %>" class="cover">

      <div class="game-card-meta">

        <% if (game.first_release_date) { %>
          <p><strong>Release Date:</strong> <%= new Date(game.first_release_date * 1000).toLocaleDateString() %></p>
        <% } %>

        <% if (game.rating) { %>
          <p><strong>Rating:</strong> <%= game.rating.toFixed(1) %>/100</p>
        <% } %>

        <% if (game.popularity) { %>
          <p><strong>Popularity:</strong> <%= Math.round(game.popularity) %></p>
        <% } %>

        <% if (game.platforms) { %>
          <p><strong>Platforms:</strong> <%= game.platforms.map(p => p.name).join(', ') %></p>
        <% } %>

        <% if (game.genres) { %>
          <p><strong>Genres:</strong> <%= game.genres.map(g => g.name).join(', ') %></p>
        <% } %>

        <% if (user) { %>
        <form action="/library/add" method="POST">
          <input type="hidden" name="game_id" value="<%= game.id %>">
          <input type="hidden" name="game_name" value="<%= game.name %>">
          <input type="hidden" name="cover_url" value="<%= game.cover?.url || '' %>">
          <button type="submit" class="btn">Add to Library</button>
        </form>
      <% } else { %>
        <a href="/login">Login to add to your library</a>
      <% } %>
      </div>
    </div>

    <div class="game-summary">
      <h1 class="game-name"><%= game.name %></h1>

      <% if (game.summary) { %>
        <!-- <h2>Summary</h2> -->
        <p class="summary-text"><%= game.summary %></p>
      <% } %>

      <!-- <% if (game.storyline) { %>
        <h2>Storyline</h2>
        <p><%= game.storyline %></p>
      <% } %> -->

      <% if (game.screenshots) { %>
        <!-- <h2>Screenshots</h2> -->
        <div class="screenshots">
          <% game.screenshots.forEach(ss => { %>
            <img src="<%= ss.url.replace('t_thumb', 't_1080p') %>" alt="Screenshot">
          <% }) %>
        </div>
      <% } %>
    </div>
  </div>
  </div>
  <%- include('partials/footer') %>